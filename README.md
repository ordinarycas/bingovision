# 🎯 BingoVision

> **智慧 Bingo 號碼辨識與連線比對工具**
>
> 拍照或上傳 Bingo 卡，自動辨識數字，即時比對已開出號碼，視覺化標記命中與連線。

[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Version](https://img.shields.io/badge/version-1.2.0-green.svg)](#)

**作者：Jhan**

---

## 📸 功能特色

### 多卡管理
- 支援同時管理多張 Bingo 卡片
- 📸 相機拍照新增（含 5×5 格線導引對齊）
- 📁 上傳圖片新增（支援多選）
- ＋ 手動新增空白卡片，直接填寫數字

### 🎨 背景色移除（v1.2 新增）
- 預設 6 組寶石/圖案背景色，辨識前自動清除
- 點擊色塊切換啟用/停用，✕ 按鈕刪除
- 自訂新增任意顏色（色彩選擇器）
- 可調容差值（15–120），控制顏色匹配範圍
- 保護深色文字像素（亮度 < 60 自動跳過）

### 智慧辨識（OCR）
- 整合 [Tesseract.js](https://github.com/naptha/tesseract.js) 瀏覽器端 OCR 引擎
- 每張卡片提供 **可拖拉的四角格線對齊工具**
- **8 步前處理流程**：背景色移除 → Min-Channel 灰階 → 對比拉伸 → Otsu → 形態學降噪
- 辨識結果填入可編輯輸入框，使用者可手動修正

### 即時比對
- 輸入已開出號碼，一鍵「✨ 比對」所有卡片
- 自動計算連線數（最多 12 條）
- 可切換中心 FREE 開關

### 視覺化結果
- 命中數字：圖片上標記 **❌ 紅色叉叉**
- 完成連線：**彩色螢光劃線**
- 逐卡顯示連線數與位置

### 自動儲存
- 所有資料（卡片、號碼、顏色設定、FREE 狀態）自動存入 LocalStorage
- 重開瀏覽器自動載入

### Debug 模式
- 檢視每格裁切後的二值化圖像
- 顯示辨識結果與信心度

---

## 🚀 快速開始

```bash
git clone https://github.com/ordinarycas/bingovision.git
cd bingovision
python3 -m http.server 8080
# 開啟 http://localhost:8080
```

---

## 📁 專案結構

```
bingovision/
├── index.html          # 主頁面
├── style.css           # 樣式表
├── js/
│   └── app.js          # 主程式
└── README.md
```

---

## 📖 使用說明

### 步驟一：設定背景色移除

🎨 面板預設包含大富翁寶果卡的 6 種寶石色：

| 色塊 | 對應 |
|------|------|
| `#CB797F` | 粉紅寶石 |
| `#7FA470` | 綠色寶石 |
| `#C85C80` | 桃紅菱形 |
| `#DE9E20` | 金黃圓形 |
| `#2A4A18` | 深綠六角 |
| `#7A1C5A` | 紫色菱形 |

可依實際卡片新增/移除顏色，調整容差值。

### 步驟二：新增卡片

📸 拍照 / 📁 上傳 / ＋ 手動新增

### 步驟三：校準格線 → 辨識

拖拉四角藍色拖把對齊數字區域 → 點擊「🔍 辨識」

### 步驟四：比對

輸入已開出號碼 → 「✨ 比對」→ 查看結果

---

## 🔧 OCR 前處理流程

```
原始圖片（彩色，含寶石/圖案背景）
  ↓ 四角定位 → 雙線性插值 25 格
  ↓ 逐格裁切（內縮 22%）
  ↓ Step 0: 背景色移除（匹配指定顏色 → 塗白，保護暗色文字）
  ↓ Step 1: Min-Channel 灰階（取 min(R,G,B)）
  ↓ Step 2: 對比拉伸（直方圖展開 0-255）
  ↓ Step 3: Otsu 自動閾值二值化
  ↓ Step 4: 套用閾值 → 黑字白底
  ↓ Step 5: 形態學降噪（移除孤立噪點）
  ↓ Step 6: 中心裁切（去 8% 邊緣）
  ↓ Step 7: 放大至 150px + 25px 白色邊距
  ↓ Tesseract PSM 7
```

---

## 📄 授權

MIT License

---

<p align="center">
  Made with ❤️ by <strong>Jhan</strong>
</p>