# 🎯 BingoVision

> **智慧 Bingo 號碼辨識與連線比對工具**
>
> 拍照或上傳 Bingo 卡，自動辨識數字，即時比對已開出號碼，視覺化標記命中與連線。

[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Version](https://img.shields.io/badge/version-1.0.0-green.svg)](#)

**作者：Jhan**

---

## 📸 功能特色

### 多卡管理
- 支援同時管理多張 Bingo 卡片
- 📸 相機拍照新增（含 5×5 格線導引對齊）
- 📁 上傳圖片新增（支援多選）
- ＋ 手動新增空白卡片，直接填寫數字

### 智慧辨識（OCR）
- 整合 [Tesseract.js](https://github.com/naptha/tesseract.js) 瀏覽器端 OCR 引擎
- 每張卡片提供 **可拖拉的四角格線對齊工具**，精確定位 5×5 數字區域
- 逐格裁切 → 灰階轉換 → 局部 Otsu 自動閾值二值化 → 辨識
- 辨識結果填入可編輯的 5×5 輸入框，**使用者可隨時手動修正**

### 即時比對
- 輸入已開出號碼，一鍵「✨ 比對」所有卡片
- **以輸入框數值為準**（手動修正優先於 OCR 結果）
- 自動計算連線數（橫排 5 條 ＋ 直排 5 條 ＋ 對角線 2 條，最多 12 條）
- 中心格固定為 **FREE**（自由號碼，永遠算命中）

### 視覺化結果
- 命中數字：圖片上標記 **❌ 紅色叉叉**
- 完成連線：畫上 **彩色螢光劃線**（黃、綠、桃紅、青、橙）
- 輸入框命中格以紫色高亮
- 結果欄顯示連線數與連線位置（如「橫3、直2、↘斜」）

### 自動儲存
- 所有卡片資料（數字、圖片、格線位置）自動儲存至 **LocalStorage**
- 已開出號碼同步儲存
- 關閉瀏覽器後重新開啟，資料自動載入
- 支援一鍵清除全部

---

## 🚀 快速開始

### 線上使用

無需安裝任何軟體，使用瀏覽器直接開啟即可。

### 本地部署

```bash
# 1. Clone 專案
git clone https://github.com/ordinarycas/bingovision.git
cd bingovision

# 2. 啟動本地伺服器（任選一種）
# Python
python3 -m http.server 8080

# Node.js
npx serve .

# 3. 開啟瀏覽器
# http://localhost:8080
```

> ⚠️ 由於使用了 Web Worker 和相機 API，必須透過 HTTP 伺服器存取，**不能直接開啟 HTML 檔案**。

---

## 📁 專案結構

```
bingovision/
├── index.html          # 主頁面
├── style.css           # 樣式表
├── js/
│   └── app.js          # 主程式（OCR、UI、比對邏輯）
└── README.md
```

---

## 📖 使用說明

### 步驟一：新增卡片

| 方式 | 操作 |
|------|------|
| 📸 拍照 | 將 Bingo 卡對齊相機畫面的綠色格線，按「拍照新增」 |
| 📁 上傳 | 點擊「上傳圖片」，可多選多張 |
| ＋ 手動 | 點擊「＋ 手動新增卡片」，在右側輸入框逐格填入數字 |

### 步驟二：校準格線（拍照/上傳卡片）

每張卡片左側圖片上有 **4 個藍色圓形拖把**：

1. 拖拉四個角到 Bingo 卡數字區域的四角
2. 綠色虛線格子會即時跟隨更新
3. 點擊「🔍 辨識」執行 OCR

### 步驟三：確認數字

- OCR 結果自動填入右側 5×5 輸入框
- 🟡 **黃框**：辨識信心度較低，建議確認
- 🔴 **紅框**：辨識失敗，需手動填入
- 直接點擊任何格子修改數字

### 步驟四：比對

1. 在頂部輸入已開出號碼（逗號分隔）
2. 點擊「✨ 比對」
3. 查看結果：圖上叉叉 ＋ 連線劃線 ＋ 連線數

---

## 🔧 技術架構

| 技術 | 用途 |
|------|------|
| **Tesseract.js v5** | 瀏覽器端 OCR 引擎，辨識數字 |
| **Canvas API** | 圖片裁切、灰階處理、Otsu 二值化、視覺化繪圖 |
| **SVG** | 格線疊加層（支援透視變形） |
| **Pointer Events** | 觸控/滑鼠統一的拖拉操作 |
| **LocalStorage** | 客戶端資料持久化 |

### OCR 處理流程

```
原始圖片
  ↓ 四角定位（使用者拖拉）
  ↓ 雙線性插值計算 25 格座標
  ↓ 逐格裁切（內縮 20% 避開圓框）
  ↓ 灰階轉換
  ↓ 局部 Otsu 自動閾值二值化
  ↓ 放大至 150px 高 + 白色邊距
  ↓ Tesseract PSM 7（單行文字模式）
  ↓ 結果填入輸入框
```

---

## 🌐 瀏覽器支援

| 瀏覽器 | 支援 |
|--------|------|
| Chrome / Edge 90+ | ✅ |
| Safari 15+ | ✅ |
| Firefox 90+ | ✅ |
| 手機 Chrome / Safari | ✅（含相機功能） |

---

## 📋 Bingo 規則說明

- 標準 5×5 格，共 25 格
- 中心格為 **FREE**（自由格），永遠視為命中
- 連線條件：同一橫排 / 直排 / 對角線的 **5 格全部命中**
- 最多可達 12 條線（5 橫 + 5 直 + 2 對角）

```
範例：
 12, 19, 42, 55, 63
  9, 26, 39, 47, 73
  5, 18, FREE, 51, 72
  3, 28, 36, 58, 71
 15, 20, 40, 59, 61
```

---

## 🗺️ Roadmap

- [ ] 批次匯入號碼（從剪貼簿貼上）
- [ ] 匯出比對結果為圖片
- [ ] 多語言介面支援
- [ ] PWA 離線使用
- [ ] 即時開號連動（WebSocket）

---

## 📄 授權

MIT License

---

## 🙏 致謝

- [Tesseract.js](https://github.com/naptha/tesseract.js) - 瀏覽器端 OCR 引擎
- 大富翁 Bingo 卡 - 測試用卡片樣式靈感

---

<p align="center">
  Made with ❤️ by <strong>Jhan</strong>
</p>